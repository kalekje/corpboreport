% Kale Ewasiuk (kalekje@gmail.com)
% +REVDATE+
% Copyright (C) 2021 Kale Ewasiuk
%
% Permission is hereby granted, free of charge, to any person obtaining a copy
% of this software and associated documentation files (the "Software"), to deal
% in the Software without restriction, including without limitation the rights
% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
% copies of the Software, and to permit persons to whom the Software is
% furnished to do so, subject to the following conditions:
%
% The above copyright notice and this permission notice shall be included in
% all copies or substantial portions of the Software.
%
% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF
% ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED
% TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
% PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT
% SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
% ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
% ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE
% OR OTHER DEALINGS IN THE SOFTWARE.

\documentclass{corpboreport}


\setlength{\parindent}{0ex}
\newcommand{\llcmd}[1]{\leavevmode\llap{\texttt{\detokenize{#1}\ }}}
\newcommand{\cmd}[1]{\texttt{\detokenize{#1}}}
\newcommand{\qcmd}[1]{``\cmd{#1}''}
\RequirePackage{url}
\RequirePackage{showexpl}
\lstset{explpreset={justification=\raggedright,pos=r,wide=true}}
\setlength\ResultBoxRule{0mm}
\lstset{
	language=[LaTeX]TeX,
	basicstyle=\ttfamily\small,
	commentstyle=\ttfamily\small\color{gray},
	frame=none,
	numbers=left,
	numberstyle=\ttfamily\small\color{gray},
	prebreak=\raisebox{0ex}[0ex][0ex]{\color{gray}\ensuremath{\hookleftarrow}},
	extendedchars=true,
	breaklines=true,
	tabsize=4,
}
\addtokomafont{title}{\raggedright}
\addtokomafont{author}{\raggedright}
\addtokomafont{date}{\raggedright}
\author{Kale Ewasiuk (\url{kalekje@gmail.com})}
\RequirePackage[yyyymmdd]{datetime}\renewcommand{\dateseparator}{--}
\date{\today}




\title{a template for a rather \\[0.2ex]
corp{\smaller\smaller\normalfont orate} \\
bore{\smaller\smaller\normalfont ing} \\
\leavevmode\llap{{\smaller\smaller\normalfont re}}port \\[0.1ex]
}
\author{\textcopyright\ 2021 by {\bfseries Kale K.J.\ Ewasiuk}, \url{kalekje@gmail.com}}
\subtitle{%
		Some thought-provoking\\
		sub-title that inspires\\
		someone to read your\\
		boring report.
}

\logo{example-image-a}
\company{Your Organization Name Here.}
\date{\today}


\usepackage{showexpl}
\setlength\ResultBoxRule{0mm}
\edef\LTXset{justification=\raggedright,pos=r,width=0.3\linewidth}


\newcommand{\llcmdlink}[2]{\href{#2}{\hspace{-15ex}}\hspace{15ex}\llcmd{#1}}%



% todo



%\setlength{\subsecneedspace}{15em}
\begin{document}


	TODO use \~ token for enlarging page with section command, probably a nice little easy thing to do

	TODO pdf string stuff for yaml vars

	TODO uni refs - make a lua table interface
	% https://tex.stackexchange.com/questions/4805/whats-the-correct-use-of-author-when-multiple-authors
	% https://tex.stackexchange.com/questions/466095/redefine-title-for-possibility-of-a-forced-line-breaking-in-a-predefined-place


	\begin{LTXexample}
		hello world

		\begin{tabular}{ l l }
			a & b \\
		\end{tabular}
	\end{LTXexample}

\maketitle


\IntentionallyBlankPage

\section{hello}

	dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\
	dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\
	dsa\\dsa\\dsa\\
	dsa\\dsa\\dsa\\
%	dsa\\dsa\\
%	dsa\\dsa\\
	dsa\\

	\subsection{Hello}
		dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\dsa\\

\section{Introduction}
todo use /And command for authors? how to handle multiple? maybe use \{\} [] [] for multi authors?

todo clean files a bit

todo if at title or author (required meta data) not defined, should we throw an error telling the user that? Would be helpful

todo adopt "string" cleaning for pdf string in MH report, clean the right header and set to pdf title, do same for author

A Corporate-Friendly Boring Template.

This class is based off the scrartcl class in the KOMA-Script family.
Don't let the name fool you---although plain and unassuming with a (dare I say) Word-like appearance,
this template has a few bells and whistles that make your TeXing easier.
It could easily lend itself well to school assignments or lab reports,

\section{Quick start guide}

\section{Options}
Memo
Serif
Compact


This document uses the "compact" version of the report. This simply disables section breaking on a new page,
and instead of a dedicated title page, it places the title as a top part. \cref{TitlePage} shows
what the title page would look like if no options are passed to this class.

The memo format is intead to be used as an Interoffice Memorandum. It adds a few doc parameters

\section{Sections}

This format uses KOMA script, so any commands are fair-game.

This class by default will insert a page break on a new section.
Using the etoolbox package, you can disable this behaviour.

if you want to invert the behaviour for a particular section, use !

For paragraphs, if you would like the text to appear on a new line (rather than run in), use !.

\lstset{language=tex}
\begin{lstlisting}
use [short title for ToC]{Section title}
		* will suppress number and ToC listing
\section{}
\subsection
\subsubsection
\paragraph
Custom
\section! will not necessarily put the section on a new page. By default, sections go on a new page
\paragraph!   Will push the following text on a new line. Without "!", the text begins on the same line as the heading
On any of the section/sub commands, using a + will add a letter after it.
\end{lstlisting}

The sections are redefined so that \texttt{+} will append a letter. \cmd{\reset[sub]sectionletter}

	\subsection{test}
	\subsection+{test}
		\subsubsection{test}
		\subsubsection+{test}
	\subsection+{test}
	\resetsubsectionletter
	\subsection+{test}
%
todo use AtBeginDocument and AtEndDocument -- do at end for  end of memo/report\\
	1\\2\\3\\4

\section{Document Commands}
THe title of this document is redined, and uses the kOMA commands
\subsection{Yo}
title
subtitle
author
date
company (equivalent to publishers)
logo (added, path to graphics)

\section{Tweaking the format}

\section{Float commands}

This package offers float commands for inserting tables and figures

\lstset{language=tex}
\begin{lstlisting}
\InsertTable[htbp]%  NOTE: if you put a * after InsertTable, it will make it a wide table, no star will indent the table a bit
{you can \input here or type \begin{tabular}...%
{Caption goes here: egManitoba interface transfers.}%
{\label{t.trans}}% label goes here
[optional]%Optional table footnotes here
\end{lstlisting}



\lstset{language=tex}
\begin{lstlisting}
\InsertFigure[htbp]%NOTE: if you put a * after InsertFigure it will make it a wide Figure, no star will indent the table a bit
{\includegraphics{+filler/fig}}%
{A long run on caption that is needlessly long}%
{\label{f.1}}%
\end{lstlisting}



\lstset{language=tex}
\begin{lstlisting}
\RotPDF*+{\include...}
	* star will restore the pdf back to normal orientation
	+ will add a pagebreak before

\RotFloatPage{\Insert...}
   If you want a rotated float (figure or table) on its own page, use this with the [H] float placement
\end{lstlisting}



\section{Tabular matter}

\subsection{References}

todo add links here

	\url{https://en.wikibooks.org/wiki/LaTeX/Tables}
	\url{booktabs}
\url{https://ctan.org/pkg/lutabulartools}

	\begin{tabular}{l l}\toprule
		Column & Use \\
		N\{X.Y\} & siunitx number column (where X.Y is number format)\\
		X,Z,Y & tabularx column, ragged right, or cenered\\
		P\{, M & top/middle center p column\\
		p\{, m, b & top/middle/borrom left align column\\
%		\~ & inject default tablcolsep\\
		\bottomrule
		\end{tabular}

\begin{lstlisting}
		P{} hori centered p clolumn
	lrc	p{}
		b{}		R{X.Y}, N{X,Y}, and L{X.Y}
		m{}


\toprule
\midrule
\bottomrule		\cmidrule(){}
\gmidrule		custom light gray mid rule

\end{lstlisting}

	\begin{tabular}{l c}
		hello\newline world & c \\
	\end{tabular}

Note: if using a float,
After end{tabular}\%\\
Make sure a \% and no new lines after, this improves

\subsection{hacks}
\begin{lstlisting}
		 for vertical spacing, use \renewcommand{\arraystretch}{1.2}
		 use @{} before and after column types, @{'code'} removes the spacing, but inserts code between column
		 use >{'code'} <{'code'} to sandwich a cell with code of your choice
		 with N, Q, L, R type columns, need to surround text with {} (and text that may come after a number) to get alignment correct
\end{lstlisting}


\subsection{Common Errors}
Common Errors
	Extra \textbackslash cr	You have too many \& or forgot to put a \textbackslash\textbackslash to end your row
	siunitx invalid input	You probably forgot to wrap text wit \{\}  (note that you should not wrap multicolumn with \{\})
	tex capacity exeeded	put \{\} after midrule ?
	\textbackslash MC on a p\{\} column?


\section{List commands}

\begin{lstlisting}
\ContParaAfterList	If you're showing a list (itemize) and want the list to be in the same paragraph as the next lines, use this command to fix the spacing
	Otherwise, it will assume a new pagagraph follows the list and space will be larger
Lists	\begin{itemize/enumerate}[moresep] will give more room between items
	[twocol] will put them over two columns
\end{lstlisting}

	Added an autoamtically punctuate list. This is particularly useful if you have a large list and aren't entirely sure of the order

\begin{itemize}[autopunc]
	\item one
	\item two
	\item three
	\item four
\end{itemize}

\section{Hacks}

\lstset{language=tex}
\begin{lstlisting}
With KOMA-Script, we can make margin wider or smaller
\begin{addmargin}[left indentation]{indentation}
content
\end{addmargin}
\phantom{} makes an invisible character

\llap, \rlap, \clap	Allows text to have no width, left, right, center aligned
	llap used for hanging labels (section, fig, tables), but these are good for table hacking to create an item of zero width

Horizontal spacing	%https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing
	I use \, to produce a thin space


\end{lstlisting}

\section{Other}

\begin{lstlisting}
\hl{highlight text}
\todo{todo note in margin}
\todoL{todo note on a new line}
\end{lstlisting}


\IntentionallyBlankPage

\section{packages}

\llcmdlink{makecell}{http://mirrors.ctan.org/macros/latex/contrib/makecell/makecell.pdf}Used by

\section{Typography}

\begin{lstlisting}
References
	I use the facilities of the cleveref package, which automatically type Figure Table etc
	I like using s. f. t. etc. to label my things, it's easier to type than the typically used sec: fig: tab:
	Examples:
	\cref{f.m602fTOV}
	\label{s.steadystate}

Citation
	The .bib files contain the refence information
	\cite
	\citeT


Typing units like kV, MW
	Use a backslash in front. I define units using the siunitx package
	\kV  \MW
	This produces a smaller space and keeps the units together

Know your dashes
	- is a hyphen: old-timers
	-- is an en-dash, used for ranges like 0--60
	--- is an em-dash, Kale---the cool guy---said that…

Know how spaces, new lines, and comments work in LaTeX
	this will
	be on the same line.

	New paragraph.
	Supercali%
	fragilstitic


	This is useful to break
	ideas into separate lines
	And it's easy to move lines around if you change you mind
\end{lstlisting}



\section{Dependencies}
dsdasdas dsadas
dsaas dsadas

\PrintEndOfDocument*

\section{Hydro Stuff}

\begin{lstlisting}
	Hydro Report Macros	R:\TariffStudies\MH-Report-Template\_boilerplate\HydroMacros.sty

\Study	Produces ies, ifs, sis, fs (or group in front) and enters glossary item
\aStudy	an ies, a fs, etc. does this correctly
\Agreement	Same as above but with agreement
\GenStation	Types out the generating station
\Request	Puts IR or TSR
\Firm	Puts NRIS if it's a generator study, DNR if it's a tariff study
\SecS	Puts NRIS if it's a generator study, DNR if it's a tariff study
\ifIFS{x}[y]	Types x if study type is ifs, otherwise types y (optional)
\ifGroupStudy
\ifTariffStudy
\PSSE	\Mhtrans (mh transmission system)
\Customer	IC for oait, EC for oatt
\IntUpgrades	isus and toids





When typing acronyms	Excel spreadsheet is used to manage acronyms
	Best to use \gls{oait}
	For example. This will ensure Open Access Interconnection Tariff is only typed the first time

\end{lstlisting}

\end{document}